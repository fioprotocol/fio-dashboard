# Generated by generator-ezetech

## Client

#### Documentation: [Create-React-App](https://facebook.github.io/create-react-app/docs/getting-started).
`https://github.com/facebook/create-react-app`

##### Run tests:
```
npm test
```
In case you can't run tests: `brew install watchman` 

## Server

### Run server in dev mode

Create `.env` file from `.env.example` template:

```ini
HASH_SECRET=secret
JWT_SECRET=secret

SQL_HOST=localhost
SQL_PORT=5432
SQL_DB=boilerplate
SQL_USER=boilerplate
SQL_PASS=password

API_PORT=9000
BASE_URL=/
PORT=3000
NODE_LOGGER_TYPE=default
```

Run docker-compose:

```bash
docker-compose up
```

Then run

```bash
npm run server:dev
```

Notice:
Before start app in dev mode you need to run `npm install`

### Run tests for server

```bash
npm test:api
```
### Build embed widgets

How to create embed widget? That's super easy.
- Go to folder `src/widgets` and create a folder with a widget name.
- Create entry points for widget.
- Create a `html` file with `REACT_APP_WIDGET` id in `public` folder for your widget.
- Create `run` and `build` npm script in `package.json` file.
- Run script should be like `"export REACT_APP_WIDGET=${REACT_APP_WIDGET} && npm run client:start"`.
- Build script should be like `"export REACT_APP_WIDGET=${REACT_APP_WIDGET} && npm run client:build && source ./bin/build-widget.sh"`.

Before build:
- install jq package `https://stedolan.github.io/jq/`

How to build embed widget?
- Set `WIDGET_PUBLIC_URL` in `client/.env` file. If you want to test it locally set full path to build folder.

How to use embed widget?
- Copy files from `client/build/${YOUR_WIDGET_NAME_FOLDER}` to your host server.
- Go to `${YOUR_WIDGET_NAME_FOLDER}` folder on your server.
- Share `${REACT_APP_WIDGET}.js` file to web.
- Paste content from `widget.html` on other website.
- Voila!

### BitPay integration

If you want to use BitPay locally you need to have public access to your running application for webhook and payment BitPay site redirectUrl. How to easy handle this on your machine?

1. Install nginx - `https://www.nginx.com/` 
Useful links:
- `https://www.cyberciti.biz/faq/nginx-restart-ubuntu-linux-command/`
2. Install ngrok - `https://ngrok.com/`
- You need to register there
3. Configure nginx:
- I have 5555 port, you could use any other port you want. Add this to you `nginx.conf` server part:
```server {
        # some default settings...
        
        listen       5555;
        server_name  localhost;

        location / {
            proxy_pass http://localhost:3000;
        }

        location /api/v1 {
            proxy_pass http://localhost:9006;
        }
    }
```
4. Run nginx
5. Run ngrok with command ```ngrok http 5555```
6. Ngrok will return a pubilc url address like `https://564b-178-133-53-168.ngrok.io`. Set it as `API_BASE_URL` and rerun server. Every time you run ngrok your public url address changes re-setup `API_BASE_URL` and rerun server.
Enjoy!
